<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Gravisim Issues</title>
	<style type="text/css">
		body{background-color:black;}
		#stats{
			position: absolute;
			background-color: rgb(30, 30, 40);
			border: 2px solid rgb(255,255,255);
			border-radius: 10px;
			left: 8px;
			padding: 15px 15px 15px 15px;

		}
		.particle{
			border-radius: 100%;
			width: 20px;
			height: 20px;
			position: absolute;
		}
		.pixels{
			width: 2px;
			height: 2px;
			pading: 0px 0px 0px 0px;
			margin: 0px 0px 0px 0px;
			float: bottom;
			position: absolute;
			border: 0px;}
		#anchor{
			box-shadow: 0 0 20px 1px white;
			background-color: white;
			top: 250px;
			left: 500px;
		}
		#subject{
			box-shadow: 0 0 20px 1px red;
			background-color: red;
			top: 250px;
		}
		#conclusion{
			color: white;
		}
	</style>
</head>
<body>
	<div id="stats">
		<text id="conclusion">
			Gravity can't be perfectly simulated using numerical methods like Euler's Method.<br>
			Optimally, in a situation like this, the position graph should be periodic and cyclical, always touching the two lines. And the tangent when the two particles meet should be vertical. <br>
			However, this fails because the particle gains velocity falling into the center, and thus spends less frames moving away from the center and thus experiences less total velocity. <br>
			This isn't an issue in physics because the universe's framerate is functionally infinite, so the accelerations get added up properly anyway. Not feasible in this simulation. <br>
			The two easiest options to implement are to add a softener to the gravity formula to remove asymptotes (option 2) or remove gravity at low distances (option 3). <br>
			I decided to use option 3, with a minimum distance of 40, for the simulation <br>
		</text>
	</div>
	<p class="particle" id="anchor"></p>
	<p class="particle" id="subject"></p>

	<script type="text/javascript">
		let bod = {
			pos: 100,
			v: 0,
			a: 0
		}
		let formula = Number(prompt("Select your formula: 1-Accurate, 2-Softener, 3-No Accel"));
		let secondaryNumber;
		if (formula == 2) {
			secondaryNumber=Number(prompt("What should the softener be?"))
		}
		if (formula == 3) {
			secondaryNumber=Number(prompt("From what distance should acceleration be 0?"))
		}

		let el = document.getElementById("subject");
		el.style.left = bod.pos+500+"px";
		let iter = 0;

		function graph(x, y, left, height, color = "white") {
		let tmp = document.createElement("p");
		tmp.style.backgroundColor = color;
		tmp.className = "pixels"
		tmp.style.top = height-y+"px";
		tmp.style.left = x+left+"px";
		document.body.appendChild(tmp);}

		function line(length, y, left, height, color = "white") {
		let tmp = document.createElement("p");
		tmp.style.backgroundColor = color;
		tmp.className = "pixels"
		tmp.style.top = height-y+"px";
		tmp.style.left = left+"px";
		tmp.style.width = length+"px"
		document.body.appendChild(tmp);}

		line(screen.width, 100, 0, 500)
		line(screen.width, -100, 0, 500)


		function running() {
			iter++;

			if (formula == 1) {
				bod.a = -Math.sign(bod.pos)*100/(bod.pos**2);
				graph(iter, bod.pos, 0, 500);
			}

			if (formula == 2) {
				bod.a = -Math.sign(bod.pos)*100/(secondaryNumber**2+bod.pos**2);
				graph(iter, bod.pos, 0, 500);
			}

			if (formula == 3) {
				if (Math.abs(bod.pos)>secondaryNumber) {
					bod.a = -Math.sign(bod.pos)*100/(bod.pos**2);
					graph(iter, bod.pos, 0, 500);
				}
				else {
					bod.a = 0; 
					graph(iter, bod.pos, 0, 500, "red");
				}
			}

			let tmp = bod.v
			bod.v += bod.a;
			bod.pos += tmp;
			el.style.left = bod.pos+500+"px";
			bod.a = 0;
		}

		let run = setInterval(running, 10);
	</script>
</body>
</html>
